<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Kartu Ucapan dari Jalee â€” Lizha ğŸ’—</title>
<style>
  /* ===== Base & Theme (Pink estetik, dramatis) ===== */
  :root{
    --bg1: #ffd6e8;
    --bg2: #ffb6d9;
    --accent: #ff2c82;
    --soft: rgba(255,44,130,0.12);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:"Poppins",system-ui,Arial,sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#3b102b;overflow:hidden}

  .app {height:100%;display:flex;align-items:center;justify-content:center;position:relative;padding:24px}
  .view {position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:28px;transition:opacity .6s ease, transform .6s ease;opacity:0;pointer-events:none}
  .view.active {opacity:1;pointer-events:auto}
  .fade-in {transform: translateY(0); opacity:1}
  .fade-out {transform: translateY(12px); opacity:0.0}

  /* Card box */
  .card {
    width:100%;
    max-width:880px;
    background:linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,255,255,0.92));
    border-radius:20px;
    padding:34px;
    box-shadow: 0 20px 60px rgba(183,60,120,0.12);
    text-align:center;
    border:1px solid var(--soft);
  }

  h1{margin:0 0 8px;font-size:34px;color:var(--accent);text-shadow:0 6px 26px rgba(255,44,130,0.08)}
  p.lead{margin:0 0 18px;color:#6b173f;font-size:18px;line-height:1.6}

  .btn {
    display:inline-block;
    background:linear-gradient(90deg,var(--accent),#ff6fa8);
    color:white;padding:12px 20px;border-radius:14px;border:none;font-weight:700;font-size:16px;
    box-shadow:0 10px 30px rgba(255,44,130,0.16);cursor:pointer;
  }
  .btn.ghost {background:transparent;color:var(--accent);border:2px solid rgba(255,44,130,0.12);box-shadow:none}
  .small {padding:10px 14px;font-size:15px;border-radius:12px}

  /* Popup letter */
  .popup {
    position:fixed;left:50%;top:50%;transform:translate(-50%,-50%) scale(.86);
    width:92%;max-width:520px;background:#fff;border-radius:16px;padding:20px;box-shadow:0 24px 80px rgba(183,60,120,0.18);
    opacity:0;pointer-events:none;transition:transform .45s cubic-bezier(.2,.9,.2,1),opacity .45s;
  }
  .popup.show {opacity:1;pointer-events:auto;transform:translate(-50%,-50%) scale(1)}
  .popup h3{margin:0 0 8px;color:var(--accent)}
  .popup p{color:#4b1a3a;line-height:1.6}

  /* Glitter + confetti + hearts layer */
  .effects {position:fixed;inset:0;pointer-events:none;overflow:hidden;z-index:20}
  .spark {position:absolute;width:6px;height:6px;border-radius:50%;background:rgba(255,255,255,0.85);filter:blur(.6px);opacity:.9}
  .emoji {position:absolute;font-size:20px;will-change:transform,opacity}

  /* final message */
  .final {text-align:center;padding:20px}
  .final h2{color:var(--accent);margin-bottom:8px}

  /* responsive */
  @media (max-width:520px){
    h1{font-size:26px}
    .card{padding:20px;border-radius:14px}
    .btn{font-size:15px}
  }
</style>
</head>
<body>
  <div class="app" id="app">

    <!-- Effects layer -->
    <div class="effects" id="effects"></div>

    <!-- VIEW 1: Intro (index) -->
    <section id="view-intro" class="view active" aria-hidden="false">
      <div class="card" role="region" aria-label="Intro">
        <h1>Untuk Lizha yang cantiikk imutt lucuu ğŸ«¶ğŸ»ğŸ«¶ğŸ»</h1>
        <p class="lead">Ketuk di mana saja untuk membuka kartu spesial ini. Musik akan menyala pelan â€” nikmati.</p>
        <button id="open-anywhere" class="btn">Buka Kartu Ucapan dari Jalee</button>
        <p style="margin-top:14px;color:#8a2a4b;font-size:14px"></p>
      </div>
    </section>

    <!-- VIEW 2: Card -->
    <section id="view-card" class="view" aria-hidden="true">
      <div class="card" role="region" aria-label="Kartu Ulang Tahun">
        <h1>Selamat Ulang Tahun Lizha Tri Wahyunii Cantikk ğŸ’—</h1>
        <p class="lead">Ini harinya. Semoga doa dan senyum lizha dikabulkan yaaa. Buka surat cintaku ya.</p>
        <button id="open-letter" class="btn">Buka Surat Cinta ğŸ’Œ</button>
      </div>
    </section>

    <!-- VIEW 3: Final / After download -->
    <section id="view-final" class="view" aria-hidden="true">
      <div class="card final" role="region" aria-label="Penutup">
        <h2>Terima Kasih ğŸ’–</h2>
        <p class="lead">Semoga harimu penuh kejutan Lizhaa. Cek hadiahmu â€” semoga kamu seneng yaa dan membuatmu tersenyum.</p>
        <button id="replay" class="btn ghost small">Kembali</button>
      </div>
    </section>

    <!-- Popup letter (global) -->
    <div id="popup" class="popup" role="dialog" aria-modal="true" aria-hidden="true">
      <h3>ğŸ’Œ Kartu Ucapan buat Lizhaa dari Jalee </h3>
      <p id="popup-text">
        Lizhaaaâ€¦<br><br>
        Di hari spesial ini aku ingin kamu tahu kaloo lagi ngobrol, nelponn, video call teh nyaman wee ama kamuu pengen tiap hari wee gtu teh. 
        Terima kasih sudah berjuang sejauh ini atas kehidupan kamu, kamu keren bangett. Semoga doa-doamu dikabulkan, dan hidupmu dipenuhi kebahagiaan yang hangat.
      </p>
      <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
        <button id="take-surprise" class="btn small">Ambil Kejutan ğŸ</button>
        <button id="close-popup" class="btn ghost small">Tutup</button>
      </div>
    </div>

  </div>

  <!-- SINGLE AUDIO (only on this SPA) -->
  <audio id="audio" src="musik.mp3" preload="auto" loop crossorigin="anonymous"></audio>

<script>
/* ====================
   SPA logic & effects
   ==================== */

const views = {
  intro: document.getElementById('view-intro'),
  card: document.getElementById('view-card'),
  final: document.getElementById('view-final')
};
const popup = document.getElementById('popup');
const effects = document.getElementById('effects');
const audio = document.getElementById('audio');

let musicStarted = false;

// Volume setting: "sangat halus" = 0.2
audio.volume = 0.20;

// utility: show a view
function showView(name){
  Object.values(views).forEach(v=>{
    v.classList.remove('active');
    v.setAttribute('aria-hidden','true');
  });
  views[name].classList.add('active');
  views[name].setAttribute('aria-hidden','false');
}

// Start music (called on first user gesture)
function startMusicThenGoToCard(){
  if (musicStarted) {
    // already started â€” just navigate
    showView('card');
    return;
  }
  // try play
  audio.play().then(()=>{
    musicStarted = true;
    // small delay so audio has started (helps iOS keep-play-after-navigation within SPA)
    setTimeout(()=> showView('card'), 180);
  }).catch(err=>{
    // if blocked for some reason, still navigate
    console.warn('Play blocked or failed:', err);
    showView('card');
  });
}

/* ===== Click-anywhere handler (only once) ===== */
// User chose "klik dimana saja" â€” attach one-time listener
document.getElementById('open-anywhere').addEventListener('click', startMusicThenGoToCard);
document.body.addEventListener('click', function onBodyClick(e){
  // if clicked an interactive control, let its own handler run
  // otherwise treat as "open anywhere"
  if (!e.target.closest('button')) {
    startMusicThenGoToCard();
  }
  // run only once
  document.body.removeEventListener('click', onBodyClick);
}, { once: true, capture: true });

/* also allow pressing keyboard Enter/Space to start */
document.addEventListener('keydown', function kd(e){
  if (!musicStarted && (e.key === 'Enter' || e.key === ' ')) {
    startMusicThenGoToCard();
    document.removeEventListener('keydown', kd);
  }
});

/* ===== Card view interactions ===== */
document.getElementById('open-letter').addEventListener('click', ()=>{
  popup.classList.add('show');
  popup.setAttribute('aria-hidden','false');
  // subtle confetti burst + hearts when popup opens
  burstConfetti(36);
  burstHearts(12);
});

/* Popup controls */
document.getElementById('close-popup').addEventListener('click', ()=>{
  popup.classList.remove('show');
  popup.setAttribute('aria-hidden','true');
});

/* "Ambil Kejutan" - triggers download + go to final view */
document.getElementById('take-surprise').addEventListener('click', ()=>{
  // download the excel file (must be at same folder)
  const a = document.createElement('a');
  a.href = 'lizhahbd.xlsx';
  a.download = 'lizhahbd.xlsx';
  document.body.appendChild(a);
  a.click();
  a.remove();

  popup.classList.remove('show');
  popup.setAttribute('aria-hidden','true');

  // small delay then show final view
  setTimeout(()=> {
    showView('final');
    // small celebratory burst
    burstConfetti(60);
    burstHearts(24);
  }, 350);
});

/* Replay (back to intro) - music remains playing */
document.getElementById('replay').addEventListener('click', ()=> {
  showView('intro');
});

/* ====================
   Visual effects
   ==================== */

function rand(min,max){ return Math.random()*(max-min)+min; }

function burstConfetti(n=40){
  for (let i=0;i<n;i++){
    const el = document.createElement('div');
    el.className = 'emoji';
    el.textContent = ['ğŸ‰','âœ¨','ğŸŒ¸'][Math.floor(Math.random()*3)];
    const size = rand(14,30);
    el.style.fontSize = size+'px';
    el.style.left = rand(10,90)+'vw';
    el.style.top = '-10vh';
    el.style.opacity = 1;
    effects.appendChild(el);

    const dur = rand(2000,4200);
    const endX = rand(-20,20);
    el.animate([
      { transform: `translate(0,0) rotate(${rand(0,360)}deg)` , opacity:1 },
      { transform: `translate(${endX}vw, 110vh) rotate(${rand(360,1080)}deg)`, opacity:0 }
    ], { duration: dur, easing: 'cubic-bezier(.2,.9,.2,1)' });

    setTimeout(()=> el.remove(), dur+80);
  }
}

function burstHearts(n=20){
  for (let i=0;i<n;i++){
    const el = document.createElement('div');
    el.className = 'emoji';
    el.textContent = 'ğŸ’—';
    el.style.fontSize = rand(16,36)+'px';
    el.style.left = rand(5,95)+'vw';
    el.style.top = '-8vh';
    effects.appendChild(el);

    const dur = rand(2600,5400);
    el.animate([
      { transform: `translateY(0) scale(1)`, opacity:1 },
      { transform: `translateY(110vh) scale(${rand(0.9,1.6)})`, opacity:0 }
    ], { duration: dur, easing: 'linear' });

    setTimeout(()=> el.remove(), dur+80);
  }
}

/* gentle persistent sparkles */
(function spawnSparks(){
  const total = 48;
  for (let i=0;i<total;i++){
    const s = document.createElement('div');
    s.className = 'spark';
    s.style.left = rand(2,98)+'vw';
    s.style.top = rand(2,98)+'vh';
    s.style.width = rand(3,8)+'px';
    s.style.height = s.style.width;
    s.style.opacity = rand(0.35,0.95);
    s.style.transform = `scale(${rand(.4,1.2)})`;
    effects.appendChild(s);
    // shimmering
    const dur = rand(1800,4200);
    s.animate([{opacity:s.style.opacity},{opacity:0.15},{opacity:s.style.opacity}],{duration:dur,iterations:Infinity});
  }
})();

/* small background gentle confetti loop */
setInterval(()=> burstConfetti(6), 4200);
setInterval(()=> burstHearts(3), 3500);

/* ====================
   Helpful: indicate audio playback state (console)
   ==================== */
audio.addEventListener('play', ()=> console.log('ğŸµ Musik dimulai'));
audio.addEventListener('pause', ()=> console.log('â¸ Musik berhenti'));
audio.addEventListener('error', (e)=> console.warn('Audio error', e));

/* ===== Accessibility: let keyboard users open too ===== */
document.addEventListener('keyup', (e)=>{
  if (!musicStarted && (e.key === 'Enter' || e.key === ' ')) startMusicThenGoToCard();
});

</script>
</body>
</html>